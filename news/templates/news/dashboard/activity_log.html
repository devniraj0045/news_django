{% extends 'news/dashboard/base_dashboard.html' %}

{% block dashboard_content %}
<h1>Activity Log</h1>

<form method="get" style="margin-bottom: 2rem;">
    <input type="number" name="user_id" placeholder="Filter by User ID" value="{{ request.GET.user_id }}"
        style="padding: 0.5rem; border: 1px solid #ddd; border-radius: 4px;">
    <button type="submit" class="badge" style="border: none; padding: 0.5rem 1rem; cursor: pointer;">Search</button>
    {% if request.GET.user_id %}
    <a href="{% url 'dashboard_activity_log' %}" style="margin-left: 1rem; color: #666;">Clear Filter</a>
    {% endif %}
</form>

<table style="width: 100%; border-collapse: collapse;">
    <thead>
        <tr style="text-align: left; background: #f9fafb; border-bottom: 2px solid #eee;">
            <th style="padding: 1rem;">User</th>
            <th style="padding: 1rem;">Action</th>
            <th style="padding: 1rem;">Details</th>
            <th style="padding: 1rem;">IP Address</th>
            <th style="padding: 1rem;">Time</th>
        </tr>
    </thead>
    <tbody>
        {% for log in logs %}
        <tr style="border-bottom: 1px solid #eee;">
            <td style="padding: 1rem; display: flex; align-items: center; gap: 0.75rem;">
                <img src="https://ui-avatars.com/api/?name={{ log.user.username }}&background=random&color=fff&size=40"
                    alt="{{ log.user.username }}" style="width: 40px; height: 40px; border-radius: 50%;">
                <div>
                    <strong>{{ log.user.username }}</strong><br>
                    <small class="text-muted">ID: {{ log.user.id }}</small>
                </div>
            </td>
            <td style="padding: 1rem;">
                <span class="badge" style="background: 
                    {% if 'Log' in log.action %}var(--primary)
                    {% elif 'Delete' in log.action %}red
                    {% elif 'Edit' in log.action %}orange
                    {% else %}gray{% endif %};">
                    {{ log.action }}
                </span>
            </td>
            <td style="padding: 1rem;">{{ log.details }}</td>
            <td style="padding: 1rem;">{{ log.ip_address }}</td>
            <td style="padding: 1rem;">{{ log.timestamp|date:"Y-m-d H:i:s" }}</td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="5" style="padding: 2rem; text-align: center;">No activity logs found.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}